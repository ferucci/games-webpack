(()=>{"use strict";class t{constructor(t,e){this.elem=document.querySelector(t),this.elem&&(this.options=e,this.selectedId=e.selectedId,this.#t(),this.#e())}#t(){const{placeholder:t,data:e}=this.options;this.elem.classList.add("select"),this.elem.innerHTML=((t=[],e,s)=>{let i=e??"Placeholder default";const n=t.map((t=>{let e="";return t.id===s&&(i=t.value,e="selected"),`\n    <li class="select__item ${e}" data-type="item" data-id="${t.id}">${t.value}</li>`}));return`\n        <div class="select__backdrop" data-type="backdrop"></div>\n        <div class="select__input" data-type="input">\n            <span data-type="value">${i}</span>\n            <span class="triangle-icon-open" data-type="arrow"></span>\n          </div>\n          <div class="select__dropdown">\n            <ul class="select__list">\n              ${n.join("")}\n            </ul>\n        </div>\n    `})(e,t,this.selectedId)}#e(){this.clickHandler=this.clickHandler.bind(this),this.elem.addEventListener("click",this.clickHandler),this.arrow=this.elem.querySelector('[data-type="arrow"]'),this.value=this.elem.querySelector('[data-type="value"]')}clickHandler(t){const{type:e}=t.target.dataset;if("input"===e||t.target.closest(".select__input"))document.querySelectorAll(".select").forEach((t=>{if(t.closest(".select-open")){t.classList.remove("select-open");const e=t.querySelector(".triangle-icon-close");e.classList.remove("triangle-icon-close"),e.classList.add("triangle-icon-open")}})),this.toggle();else if("item"===e){const e=t.target.dataset.id;this.select(e)}else"backdrop"===e&&this.close()}get isOpen(){return this.elem.classList.contains("select-open")}get current(){return this.options.data.find((t=>t.id===this.selectedId))}select(t){this.selectedId=t,this.value.textContent=this.current.value,this.elem.querySelectorAll('[data-type="item"]').forEach((t=>{t.classList.remove("selected")})),this.elem.querySelector(`[data-id="${t}"]`).classList.add("selected"),this.options.onSelect&&this.options.onSelect(this.current),this.close()}toggle(){this.isOpen?this.close():this.open()}open(){this.elem.classList.add("select-open"),this.arrow.classList.remove("triangle-icon-open"),this.arrow.classList.add("triangle-icon-close")}close(){this.elem.classList.remove("select-open"),this.arrow.classList.remove("triangle-icon-close"),this.arrow.classList.add("triangle-icon-open")}destroy(){this.elem.removeEventListener("click",this.clickHandler),this.elem.innerHTML=""}}class e{constructor(t,e){this.options=Object.assign({isChanged:()=>{}},e),this.selector=t,this.tabs=document.querySelector(`[data-tabs="${t}"]`),this.tabs&&(this.tabList=this.tabs.querySelector(e.tabList),this.tabsBtns=this.tabList.querySelectorAll(e.tabsBtns),this.content=document.querySelector(e.content),this.contentItem=this.content.querySelectorAll(e.contentItem),this.check(),this.init(),this.events())}check(){document.querySelectorAll(`[data-tabs="${this.selector}"]`).length>1||(this.tabsBtns.length,this.contentItem.length)}init(){this.tabList.setAttribute("role","tablist"),this.tabsBtns.forEach(((t,e)=>{t.setAttribute("role","tab"),t.setAttribute("tabindex","-1"),t.setAttribute("id",`${this.selector}${e+1}`),t.classList.remove(this.options.linkActive)})),this.contentItem.forEach(((t,e)=>{t.setAttribute("role","tabpanel"),t.setAttribute("tabindex","-1"),t.setAttribute("aria-labelledby",this.tabsBtns[e].id),t.classList.remove(this.options.contentBoxActive)})),this.tabsBtns[0].classList.add(this.options.linkActive),this.tabsBtns[0].removeAttribute("tabindex"),this.tabsBtns[0].setAttribute("aria-selected","true"),this.contentItem[0].classList.add(this.options.contentBoxActive)}events(){this.tabsBtns.forEach(((t,e)=>{t.addEventListener("click",(t=>{let e=this.tabList.querySelector("[aria-selected]");t.currentTarget!==e&&this.switchTabs(t.currentTarget,e)})),t.addEventListener("keydown",(t=>{let s=Array.prototype.indexOf.call(this.tabsBtns,t.currentTarget),i=null;if(i=37===t.which?s-1:39===t.which?s+1:40===t.which?"down":null,null!==i)if("down"===i)this.contentItem[e].focus();else{if(!this.tabsBtns[i])return;this.switchTabs(this.tabsBtns[i],t.currentTarget)}}))}))}switchTabs(t,e=this.tabs.querySelector("[aria-selected]")){t.focus(),t.removeAttribute("tabindex"),t.setAttribute("aria-selected","true"),e.removeAttribute("aria-selected"),e.setAttribute("tabindex","-1");let s=Array.prototype.indexOf.call(this.tabsBtns,t),i=Array.prototype.indexOf.call(this.tabsBtns,e);this.contentItem[i].classList.remove("content__box--active"),this.contentItem[s].classList.add("content__box--active"),this.tabsBtns[i].classList.remove("content__tab-link--active"),this.tabsBtns[s].classList.add("content__tab-link--active"),this.options.isChanged(this)}}class s{constructor(t){this.options=Object.assign({isOpen:()=>{},isClose:()=>{}},t),this.modal=document.querySelector(".popup"),this.speed=!1,this.animation=!1,this._reOpen=!1,this._nextContainer=!1,this.isOpen=!1,this.modalContainer=!1,this.previousActiveElement=!1,this.fixBlocks=document.querySelectorAll(".fix-block"),this.focusElements=["a[href]","input","button","select","textarea","iframe","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.open=this.open.bind(this),this.close=this.close.bind(this),this.focusCatch=this.focusCatch.bind(this),this.focusTrap=this.focusTrap.bind(this),this.disableScroll=this.disableScroll.bind(this),this.enableScroll=this.enableScroll.bind(this),this.lockPadding=this.lockPadding.bind(this),this.unlockPadding=this.unlockPadding.bind(this),this.events()}events(){this.modal&&(document.addEventListener("click",(t=>{const e=t.target.closest("[data-path");if(e){let t=e.dataset.path,s=e.dataset.animation,i=e.dataset.speed;return this.animation=s||"fade",this.speed=i?parseInt(i):300,this._nextContainer=document.querySelector(`[data-target="${t}"]`),void this.open()}(t.target.closest(".popup__close-item")||t.target.closest(".delete__button"))&&this.close()})),window.addEventListener("keydown",(t=>{27==t.keyCode&&this.isOpen&&this.close(),9==t.keyCode&&this.isOpen&&this.focusCatch(t)})),window.addEventListener("click",(t=>{t.target.classList.contains("popup__wrapp")||t.target.closest(".popup__wrapp")||!this.isOpen||this.close()})))}open(t){if(this.previousActiveElement=document.activeElement,this.isOpen)return this.reOpen=!0,void this.close();this.modalContainer=this._nextContainer,t&&(this.modalContainer=document.querySelector(`[data-target="${t}"]`)),this.modalContainer.scrollTo(0,0),this.modal.style.setProperty("$transition-time",this.speed/1e3+"s"),this.modal.classList.add("is-open"),document.body.style.scrollBehavior="auto",document.documentElement.style.scrollBehavior="auto",this.disableScroll(),this.modalContainer.classList.add("popup-open"),this.modalContainer.classList.add(this.animation),setTimeout((()=>{this.modalContainer.classList.add("animate-open"),this.options.isOpen(this),this.isOpen=!0,this.focusTrap()}),this.speed)}close(){this.modalContainer&&(this.modalContainer.classList.remove("animate-open"),this.modalContainer.classList.remove(this.animation),this.modal.classList.remove("is-open"),this.modalContainer.classList.remove("popup-open"),this.enableScroll(),document.body.style.scrollBehavior="auto",document.documentElement.style.scrollBehavior="auto",this.options.isClose(this),this.isOpen=!1,this.focusTrap(),this.reOpen&&(this.reOpen=!1,this.open()))}focusCatch(t){const e=this.modalContainer.querySelectorAll(this.focusElements),s=Array.prototype.slice.call(e),i=s.indexOf(document.activeElement);t.shiftKey&&0===i&&(s[s.length-1].focus(),t.preventDefault()),t.shiftKey||i!==s.length-1||(s[0].focus(),t.preventDefault())}focusTrap(){const t=this.modalContainer.querySelectorAll(this.focusElements);this.isOpen?t&&t[t.length-1].focus():this.previousActiveElement.focus()}disableScroll(){let t=window.scrollY;this.lockPadding(),document.body.classList.add("disable-scroll"),document.body.dataset.position=t,document.body.style.top=-t+"px"}enableScroll(){let t=parseInt(document.body.dataset.position,10);this.unlockPadding(),document.body.style.top="auto",document.body.classList.remove("disable-scroll"),window.scrollTo({top:t,left:0}),document.body.removeAttribute("data-position")}lockPadding(){let t=window.innerWidth-document.body.offsetWidth+"px";this.fixBlocks.forEach((e=>{e.style.paddingRight=t})),document.body.style.paddingRight=t}unlockPadding(){this.fixBlocks.forEach((t=>{t.style.paddingRight="0px"})),document.body.style.paddingRight="0px"}}document.addEventListener("DOMContentLoaded",(()=>{new s;const i={placeholder:"Выберите способ покупки",selectedId:"1",data:[{id:"1",value:"Аренда через семейный доступ"},{id:"2",value:"Аренда через личный доступ"}],onSelect(){}};new t("#select-n",{placeholder:"Выберите способ покупки",data:[{id:"1",value:"Способ покупки 1"},{id:"2",value:"Способ покупки 2"},{id:"3",value:"Способ покупки 3"},{id:"4",value:"Способ покупки 4"}]}),new t("#select-1",i),new t("#select-2",i),new t("#select-3",i),new t("#select-filter-1",{placeholder:"Выберите элемент",selectedId:"1",data:[{id:"1",value:"Дате заказа"}]}),new t("#select-filter-2",{placeholder:"Выберите элемент",selectedId:"1",data:[{id:"1",value:"Сумме заказа"}],styles:[{background:"#3F434B;",boxShadow:"inset 0px 4px 16px rgba(0, 0, 0, 0.1);"}]}),new e("faq-tab",{tabList:".content__tabs",tabsBtns:".content__tab-link",content:".faq-content-box",contentItem:".content__box",linkActive:"content__tab-link--active",contentBoxActive:"content__box--active",isChanged:t=>{}}),new e("profile-tab",{tabList:".profile-content__tabs",tabsBtns:".content__tab-link",content:".profile-content-box",contentItem:".content__box",linkActive:"content__tab-link--active",contentBoxActive:"content__box--active",isChanged:()=>{}}),document.querySelector(".faq")&&(()=>{const t=document.querySelectorAll(".faq-triggers__item"),e=({currentTarget:t})=>{const e=t.querySelector("p"),s=t.querySelector(".faq-triggers__btn");e.classList.toggle("faq-triggers__text--active"),s.classList.toggle("faq-triggers__btn--active")};t.forEach((t=>t.addEventListener("click",e)))})()}))})();