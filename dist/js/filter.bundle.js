(()=>{"use strict";var e={634:(e,t,a)=>{a.d(t,{Z:()=>c});class n{constructor(e,t){this.elem=document.querySelector(e),this.elem&&(this.options=t,this.selectedId=t.selectedId,this.#e(),this.#t())}#e(){const{placeholder:e,data:t}=this.options;this.elem.classList.add("select"),this.elem.innerHTML=((e=[],t,a)=>{let n=t??"Placeholder default";const s=e.map((e=>{let t="";return e.id===a&&(n=e.value,t="selected"),`\n    <li class="select__item ${t}" data-type="item" data-id="${e.id}">${e.value}</li>`}));return`\n        <div class="select__backdrop" data-type="backdrop"></div>\n        <div class="select__input" data-type="input">\n            <span data-type="value">${n}</span>\n            <span class="triangle-icon-open" data-type="arrow"></span>\n          </div>\n          <div class="select__dropdown">\n            <ul class="select__list">\n              ${s.join("")}\n            </ul>\n        </div>\n    `})(t,e,this.selectedId)}#t(){this.clickHandler=this.clickHandler.bind(this),this.elem.addEventListener("click",this.clickHandler),this.arrow=this.elem.querySelector('[data-type="arrow"]'),this.value=this.elem.querySelector('[data-type="value"]')}clickHandler(e){const{type:t}=e.target.dataset;if("input"===t||e.target.closest(".select__input"))document.querySelectorAll(".select").forEach((e=>{if(e.closest(".select-open")){e.classList.remove("select-open");const t=e.querySelector(".triangle-icon-close");t.classList.remove("triangle-icon-close"),t.classList.add("triangle-icon-open")}})),this.toggle();else if("item"===t){const t=e.target.dataset.id;this.select(t)}else"backdrop"===t&&this.close()}get isOpen(){return this.elem.classList.contains("select-open")}get current(){return this.options.data.find((e=>e.id===this.selectedId))}select(e){this.selectedId=e,this.value.textContent=this.current.value,this.elem.querySelectorAll('[data-type="item"]').forEach((e=>{e.classList.remove("selected")})),this.elem.querySelector(`[data-id="${e}"]`).classList.add("selected"),this.options.onSelect&&this.options.onSelect(this.current),this.close()}toggle(){this.isOpen?this.close():this.open()}open(){this.elem.classList.add("select-open"),this.arrow.classList.remove("triangle-icon-open"),this.arrow.classList.add("triangle-icon-close")}close(){this.elem.classList.remove("select-open"),this.arrow.classList.remove("triangle-icon-close"),this.arrow.classList.add("triangle-icon-open")}destroy(){this.elem.removeEventListener("click",this.clickHandler),this.elem.innerHTML=""}}var s=a(433);const i=()=>{let e=document.querySelectorAll(".game-card__action-incard");const t=document.querySelector(".basket-content__games");e=document.querySelectorAll(".game-card__action-incard");const a=new class{#a=[];addItem(e){this.#a.push(e),this.save()}removeItem(e){const t=this.#a.findIndex((t=>t.id===e.id));-1!==t&&(this.#a.splice(t,1),this.save())}getItems(){return this.#a}save(){localStorage.setItem("cart",JSON.stringify(this.#a))}load(){const e=localStorage.getItem("cart");e&&(this.#a=JSON.parse(e))}};a.load();const i=()=>{const e=a.getItems().length;document.querySelector(".basket__num").textContent=e};if(i(),document.getElementById("basket-page")){console.log(a.getItems());const e=document.getElementById("form-basket"),c=()=>{0!==a.getItems().length&&document.documentElement.scrollWidth>1310?e.style.display="block":e.style.display="none"},r=e=>{const t=e.querySelector(".form-basket__total-sum > span"),n=e.querySelector(".form-basket__total-items > span"),s=document.querySelectorAll(".basket-content__game");if(c(),s){const e=Number((r=a.getItems(),r.reduce(((e,t)=>e+t.price.trim().slice(0,-1).replace(/,/g,".")*parseInt(t.quantity,10)),0))).toFixed(3),s=Number(function(e){return e.reduce(((e,t)=>e+parseInt(t.quantity,10)),0)}(a.getItems()));a.getItems().length>0&&(t.innerText=`${i=String(e),i.replace(/\./g,",")} ₽`,n.innerText=s)}var i,r},o=(t,n)=>{const s=document.querySelector(".delete__wrapp"),c=o=>{const l=document.querySelector('[aria-label="Удалить"]');o.target===l&&null!==t?(t.remove(),a.removeItem(n),i(),r(e)):(o.target.closest(".light-btn")||o.target.closest(".popup__close-item")||o.target!==s)&&(n=null,t=null,s.removeEventListener("click",c))};s.addEventListener("click",c)};a.getItems().forEach((e=>{var a,s,i,c,r;t.insertAdjacentHTML("afterbegin",(a=e.img,s=e.title,i=e.price,c=e.id,r=e.quantity,`\n    <div class="basket-content__game" data-id="${c}">\n      <div class="basket-content__game-info">\n          <img class="basket-content__game-image"\n            src="${a}" alt="game image prev">\n          <div class="basket-content__game-text">\n              <span class="basket-content__game-name">\n                ${s.trim()}\n              </span>\n              <span class="basket-content__game-sum">\n                ${i.trim()}\n              </span>\n              <div class="basket-content__control btns-control">\n                  <button class="btns-control__item" type="button" data-action="minus">-</button>\n                  <div class="btns-control__current" data-counter>${r}</div>\n                  <button class="btns-control__item" type="button" data-action="plus">+</button>\n              </div>\n          </div>\n      </div>\n      <div class="basket-content__game-select">\n          <button class="basket-content__game-del" aria-label="Удалить товар" data-path="deleteItem-path">\n              <img src="./images/icons/btn-delete.svg" alt=""></button>\n          <div class="basket-content__select-app">\n              <div class="basket-content__select-wrapp">\n\n                  <div id="select-${c}">\n\n                  </div>\n\n                </div>\n          </div>\n      </div>\n  </div> `)),(e=>{new n(`#select-${e}`,{placeholder:"Выберите способ покупки",selectedId:"1",data:[{id:"1",value:"Аренда через семейный доступ"},{id:"2",value:"Аренда через личный доступ"}]})})(e.id)})),document.querySelectorAll(".basket-content__game-del").forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget.parentNode.closest(".basket-content__game"),a={id:t.dataset.id};o(t,a)}))})),r(e);const l=()=>{document.querySelectorAll(".btns-control").forEach((e=>{const t=e.querySelector("[data-counter]"),a=e.querySelector('[data-action="minus"]');1===parseInt(t.innerText)?(a.style.color="rgb(0 141 210 / 32%)",a.disabled=!0):(a.style.color="#008dd2",a.disabled=!1)}))};l(),t.addEventListener("click",(t=>{if(!t.target.dataset.action)return;const n=t.target.closest(".btns-control").querySelector("[data-counter]"),s=t.target.parentNode.closest(".basket-content__game");"plus"===t.target.dataset.action&&(n.innerText=++n.innerText,a.getItems().forEach((e=>{s.dataset.id===e.id&&(e.quantity+=1),a.save()})),i()),"minus"===t.target.dataset.action&&parseInt(n.innerText,10)>1&&(n.innerText=--n.innerText,a.getItems().forEach((e=>{s.dataset.id===e.id&&e.quantity--,a.save()})),i()),l(),r(e)})),window.addEventListener("resize",(0,s.RA)(c))}e.forEach((e=>{e.addEventListener("click",(e=>{const t={title:(n=e.currentTarget.parentNode.closest(".game-card")).querySelector(".game-card__title").textContent,price:n.querySelector(".game-card__sum").textContent,img:n.querySelector(".game-card__img").getAttribute("src"),id:n.dataset.id,quantity:1};var n;a.getItems().some((e=>e.id===t.id||e.title===t.title))?a.getItems().forEach((e=>{const n=e;t.id===e.id&&(n.quantity+=1),a.save()})):a.addItem(t),i()}))}))};document.addEventListener("DOMContentLoaded",(()=>{i()}));const c=i},433:(e,t,a)=>{a.d(t,{Bd:()=>n,Ch:()=>i,RA:()=>c,jj:()=>s});const n=e=>e.flat().reduce(((e,t)=>(e.find((e=>e.title==t.title))||e.push(t),e)),[]),s=e=>{var t={boolean:{},number:{},string:{}},a=[];return e.filter((function(e){var n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(a.indexOf(e)>=0)&&a.push(e)}))},i=e=>e!==document.body&&document.body.contains(e);function c(e,t=200){let a;return function(n){clearTimeout(a),a=setTimeout(e,t,n)}}}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=a(634);const t="Экшен",n="Инди",s="Шутер",i="Приключения",c="Стратегия",r="Ролевые",o="Гонки",l="Файтинг",d="Казульные",g="DLC",m=[{id:111,title:"Death Stranding Q",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-0.jpg",params:{payMethod:["Личный аккаунт"],category:[t,s,"ММО",r,d]},price:"359,1299 ₽"},{id:222,title:"Death Stranding R",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-1.jpg",params:{payMethod:["Личный аккаунт","Семейный аккаунт"],category:[o,c,g]},price:"1359,1199 ₽"},{id:333,title:"Death Stranding S",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-2.jpg",params:{payMethod:["Личный аккаунт","Семейный аккаунт"],category:[r,i]},price:"559,599 ₽"},{id:444,title:"Death Stranding T",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-3.jpg",params:{payMethod:["Личный аккаунт"],category:[o,n,c,i,t,g,l]},price:"759,599 ₽"},{id:555,title:"Death Stranding U",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-4.jpg",params:{payMethod:["Личный аккаунт"],category:[o]},price:"259,699 ₽"},{id:666,title:"Death Stranding V",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-3.jpg",params:{payMethod:["Семейный аккаунт"],category:[i,r,t]},price:"2359,999 ₽"},{id:777,title:"Death Stranding W",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-2.jpg",params:{payMethod:["Личный аккаунт"],category:[i,d,g,c]},price:"13359,599 ₽"},{id:888,title:"Death Stranding X",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-1.jpg",params:{payMethod:["Семейный аккаунт"],category:[n]},price:"5359,199 ₽"},{id:998,title:"Death Stranding Y",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",params:{payMethod:["Семейный аккаунт"],category:[l,s]},price:"11059,299 ₽"},{id:999,title:"Death Stranding Z",description:"Множество игровых компаний, в том числе, EA, Ubisoft, Take-Two заявили о...",image:"./images/games/catalog/game-0.jpg",params:{payMethod:["Личный аккаунт"],category:[c,s,n]},price:"959,599 ₽"}];var p=a(433);(()=>{let t=[];if((0,p.Ch)(document.getElementById("catalog-games"))){const a={catalogGames:document.getElementById("catalog-games"),filterBlock:document.querySelector(".catalog__buttons"),filterBtns:document.querySelectorAll(".catalog-btn")},n=(e,t)=>0===Number(t)||1===Number(t)?e[t]:"+"+(+e.length-2),s=e=>{const t=[];for(let a=0;a<e.params.category.length;a+=1)t.push(`\n          <a class="game-card__genre" href="#">\n            ${e.params.category.length<3?e.params.category[a]:n(e.params.category,a)}\n          </a>     \n      `);return t.length>=3&&t.splice(3).join(""),t.join("")},i=e=>{const t=[];for(let a=0;a<e.length;a+=1)t.push(`\n        <div class="game-card" data-id="${e[a].id}">\n                  <div class="game-card__info">\n                      <div class="game-card__img-box">\n                          <img class="game-card__img"\n                          src="${void 0!==e[a].image?e[a].image:String("./images/games/catalog/default.jpg")}"\n                              alt="Death Stranding game">\n                      </div>\n                      <div class="game-card__genres">\n                        ${s(e[a])}\n                      </div>\n  \n                      <div class="game-card__accounts game-card__accounts-large">\n                          <a class="game-card__accounts-item game-card__accounts-pers" href="#">\n                          ${e[a].params.payMethod[0]}\n                          </a>\n                      </div>\n                  </div>\n                  <div class="game-card__footer">\n                      <div class="game-card__footer-box">\n                          <div class="game-card__description">\n                              <h5 class="game-card__title">\n                                  <a class="game-card__link" href="#">\n                                    ${e[a].title}\n                                  </a>\n                              </h5>\n                              <p class="game-card__subtitle">\n                                ${e[a].description}\n                              </p>\n                              <span class="game-card__sum">\n                              ${e[a].price}\n                              </span>\n                          </div>\n  \n                      </div>\n                      <div class="game-card__action">\n                          <button class="game-card__action-incard light-accent-btn">\n                              В корзину\n                          </button>\n                          <a class="game-card__action-buy light-btn" href="#">\n                              Купить\n                          </a>\n                      </div>\n                  </div>\n              </div>\n          `);return t};a.catalogGames.innerHTML=i(m).join("");const c=e=>{const t=document.querySelectorAll(".catalog-btn--active").length,a=document.getElementById("selected-categories"),n=document.getElementById("selected-games");a.innerText=t,n.innerText=`( ${e} )`},r=n=>{let s=[];n.addEventListener("click",(n=>{const r=n.target,o=r.dataset.fil;if(r.classList.toggle("catalog-btn--active"),s=m.filter((e=>{const t=new RegExp(o),a=e.params.category;return t.test(a)})),r.closest(".catalog-btn--active"))t.push(s),t=(0,p.jj)((0,p.Bd)(t));else{const e=[...document.querySelectorAll(".catalog-btn--active")],a=[];e.forEach((e=>{const t=e.dataset.fil;a.push(t)})),t=t.flat().filter((({params:e})=>e.category.some((e=>a.includes(e)))))}c(Number(t.length));const l=i((0,p.jj)((0,p.Bd)(t).flat()));a.catalogGames.innerHTML=(0,p.jj)(l.flat()).join(""),(0,e.Z)()}))};a.filterBtns.forEach((e=>r(e)))}})()})()})();